# jOOQ에 대해 몰랐던 10가지

> 원문: https://blog.jooq.org/10-things-you-didnt-know-about-jooq/

## 1. XSLT에서 영감을 받은 연산자 약어

짧은 연산자 이름인 `eq`, `ne`, `gt`, `ge`, `lt`, `le`는 임의로 선택된 것이 아니라 XSLT/XPath 규칙에서 영감을 받았습니다. 이러한 약어들은 `greaterOrEqual()`과 같은 무거운 메서드 이름 없이도 DSL을 읽기 쉽게 유지합니다. 흥미롭게도 jOOQ의 SQL 파서는 이러한 약어를 사용하는 Teradata의 대체 문법까지 지원합니다.

## 2. API 네이밍에 대한 후회

창시자가 바꾸고 싶어하는 세 가지 네이밍 결정이 있습니다:

- Field (실제로는 컬럼/표현식을 나타내며, 스프레드시트 필드가 아님)
- Condition (SQL 표준에서는 이를 술어(predicate)라고 부름)
- Record (이제 Java의 네이티브 `Record` 타입과 충돌함; `Row`가 더 나았을 것)

이것들은 모든 jOOQ 애플리케이션을 깨뜨리지 않고는 현실적으로 변경할 수 없습니다.

## 3. 언태그드 유니온 타입으로서의 오버로드

jOOQ의 광범위한 메서드 오버로드는 본질적으로 TypeScript의 언태그드 유니온 타입을 에뮬레이트합니다. 예를 들어, `DSL::substring`은 다양한 인자 타입(String, Name, Field, Select)을 처리하기 위해 여러 오버로드를 가지고 있습니다. Java에 진정한 유니온 타입이 없기 때문에 어떤 순열을 직접 지원할지에 대한 실용적인 결정이 필요합니다.

## 4. 복잡한 SQL 변환의 어려움

12년이 지난 지금도 30개의 지원 데이터베이스에 걸쳐 복잡한 SQL 기능 조합을 변환하는 것은 여전히 어렵습니다. 중첩된 CTE, ORDER BY 절이 있는 파생 테이블, 복잡한 UNION 구조는 모든 방언이 동일한 문법 조합을 지원하지 않는 엣지 케이스를 만들어냅니다.

## 5. 공식 발음

공식 발음은 "dʒuːk"(juke와 같은 발음)이며, SQL 발음 패턴과 일치합니다. jOOQ는 "jOOQ Object Oriented Querying"의 약자이지만, 객체 지향에 대한 강조는 의도된 사용 패턴보다는 API 설계 철학을 설명합니다.

## 6. RDBMS 버그 발견

jOOQ는 포괄적인 통합 테스트를 통해 수많은 데이터베이스 버그를 발견했습니다. 파생 테이블 내의 중첩된 CTE와 같은 비정상적인 문법 조합을 테스트하면 다양한 RDBMS의 구현 버그가 드러납니다. 이 프로젝트는 발견 사항을 공개 트래커와 Stack Overflow에 문서화합니다.

## 7. 설계 실수로서의 가변성

가변적인 DSL 문을 지원한 것은 기존 코드를 깨뜨리지 않고는 되돌릴 수 없는 중대한 아키텍처 실수였습니다. 예를 들어:

```java
SelectWhereStep<?> s = ctx.select(T.A, T.B).from(T);
if (something) s.where(T.C.eq(1));  // 객체를 변경함
```

이것은 작동해서는 안 되지만, 수정하면 수많은 애플리케이션이 깨질 것입니다. 라이브러리는 이제 가변 패턴을 억제하기 위해 `@CheckReturnValue` 어노테이션을 사용합니다.

## 8. 동작 및 소스 호환성 우선순위

동작 호환성은 협상 불가능합니다. 소스 비호환성은 주요 릴리스에서 설득력 있는 이유가 있는 경우를 제외하고는 피합니다. 예시: `where()` 절에 대한 `Boolean` 오버로드를 제거한 것인데, 사용자들이 실수로 `.where(field.eq(value))` 대신 `.where(field.equals(value))`를 작성하여 오타로 인해 잘못된 오버로드를 선택했기 때문입니다.

## 9. 바이너리 호환성은 거의 불가능

Java 기반 DSL에서는 바이너리 호환성을 유지할 수 없습니다. Teradata의 `QUALIFY` 절이 추가되었을 때, 윈도우 관련 메서드의 반환 타입이 `SelectOrderByStep`에서 `SelectQualifyStep`으로 변경되었습니다. 공변 오버로드는 언어 수준에서는 작동하지만, 바이트코드 호환성은 실패합니다—클라이언트는 반드시 재컴파일해야 합니다.

## 10. 로고 디자인의 진화

현재 로고는 창시자의 아내가 "전혀 마음에 들어하지 않았던"("어떤 피투성이 사무라이 같다"고 표현한) 이전 디자인을 대체했습니다. 채택된 주요 디자인 원칙:

- 흑백은 모든 미디어에서 작동함
- 정사각형 형식이 직사각형보다 확장성이 좋음
- 로고는 SVG 스케일링 없이 20x20 비트맵 디자인을 사용함
