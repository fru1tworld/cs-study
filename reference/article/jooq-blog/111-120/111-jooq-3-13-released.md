# jOOQ 3.13 릴리스 - DDL 관리를 위한 더 많은 API 및 도구

> 원문: https://blog.jooq.org/jooq-3-13-released-with-more-api-and-tooling-for-ddl-management/

게시일: 2020년 2월 | 작성자: lukaseder

---

## 소개

jOOQ 3.13이 DDL 관리를 위한 더 많은 API 및 도구와 함께 출시되었습니다. 이번 릴리스에서 가장 큰 투자는 DDL 해석 기능에 있었으며, CockroachDB 지원, SQL:2011 시간 테이블, LiquibaseDatabase 통합 등 다양한 기능이 추가되었습니다.

---

## CockroachDB 지원

jOOQ 3.13에서 CockroachDB 방언이 Professional 및 Enterprise 에디션에서 공식적으로 지원됩니다. 이전에는 사용자들이 POSTGRES 방언에 의존해야 했지만, 이제 전용 방언이 제공됩니다.

jOOQ 팀은 CockroachDB 엔지니어들과 협력하여 통합 테스트를 수행했으며, 향후 jOOQ 및 CockroachDB 버전에서도 지속적인 호환성을 보장합니다.

---

## DDL 해석

이번 릴리스에서 가장 큰 투자는 DDL 해석 기능에 있었습니다. jOOQ 3.13은 DDL 문을 파싱하고 해석하는 능력을 크게 확장하여 증분 인메모리 데이터베이스 메타 모델을 유지합니다.

### 주요 기능:

* 스키마 diff 생성: `Meta.migrateTo(Meta)` API를 통해 프로그래밍 방식으로 스키마 diff를 생성할 수 있습니다
* 명령줄 diff: DiffCLI를 통한 명령줄 diff 기능
* 온라인 스키마 비교: jooq.org/diff에서 온라인으로 스키마 비교 가능
* 임시 인트로스펙션: 즉석에서 스키마를 검사하는 기능
* 자동화된 마이그레이션: 스키마 마이그레이션 자동화 지원

이러한 기능들은 데이터베이스 스키마 변경을 추적하고 관리하는 데 매우 유용합니다.

---

## SQL:2011 시간 테이블 지원

jOOQ 3.13은 SQL:2011 표준에 따른 시간 테이블(Temporal Table) 지원을 도입합니다. 시간 테이블은 두 가지 버전 관리 차원을 제공합니다:

### 시스템 버전 관리 (System Versioning)

시스템 버전 관리는 감사 및 백업 목적으로 사용됩니다. 데이터베이스가 자동으로 행의 변경 이력을 추적하여 특정 시점의 데이터 상태를 조회할 수 있습니다.

### 애플리케이션 버전 관리 (Application Time Versioning)

애플리케이션 버전 관리는 시간 제한이 있는 데이터 유효성을 위해 사용됩니다. 비즈니스 로직에서 데이터가 유효한 기간을 정의할 수 있습니다.

### 지원 데이터베이스:

이 기능은 다음 데이터베이스에서 네이티브로 지원됩니다:
* DB2
* MariaDB
* Oracle
* SQL Server

다른 방언에서의 에뮬레이션 지원도 향후 버전에서 제공될 예정입니다.

새로운 `org.jooq.Period` API를 통해 단일 또는 이중 시간 버전 관리(bi-temporal versioning) 데이터 요구사항을 처리할 수 있습니다.

---

## LiquibaseDatabase 통합

jOOQ 3.13에는 새로운 LiquibaseDatabase 타입이 도입되었습니다. 이 데이터베이스 타입은 Liquibase를 백그라운드에서 사용하여 인메모리에서 스키마 마이그레이션을 시뮬레이션합니다.

### 주요 이점:

* 데이터베이스 연결 불필요: 코드 생성 시 실제 데이터베이스에 연결할 필요가 없습니다
* 빠른 개발 사이클: 인메모리 시뮬레이션으로 더 빠른 빌드 가능
* CI/CD 통합 용이: 데이터베이스 의존성 없이 빌드 파이프라인 구성 가능

이를 통해 개발자는 실제 데이터베이스 인스턴스 없이도 jOOQ 코드 생성을 수행할 수 있습니다.

---

## JDBC DatabaseMetaData API 지원 개선

jOOQ 3.13에서는 JDBC의 DatabaseMetaData API 지원이 향상되었습니다. 이를 통해 더 많은 데이터베이스 메타데이터 정보를 jOOQ를 통해 접근할 수 있습니다.

---

## 런타임 메타 모델 확장

런타임 메타 모델이 다음과 같은 추가 정보를 포함하도록 확장되었습니다:

* 시퀀스 플래그: 시퀀스에 대한 추가 속성 정보
* CHECK 제약 조건: 테이블의 CHECK 제약 조건 정보
* 테이블 타입 정보: 테이블의 유형에 대한 상세 정보
* 뷰 SQL 텍스트: 생성된 코드에 뷰의 SQL 텍스트 포함

---

## 절차적 API 개선

jOOQ의 절차적 언어 지원이 확장되었습니다:

* EXECUTE 문: 동적 SQL 실행을 위한 EXECUTE 문 지원
* RETURN 문: 저장 프로시저에서 값 반환을 위한 RETURN 문 지원
* Plain SQL 문: 저장 프로시저 내에서 plain SQL 문 지원

---

## jOOQ-Refaster 통합

jOOQ 3.13은 ErrorProne의 Refaster 하위 프로젝트와 통합됩니다. 이를 통해 자동화된 API 마이그레이션이 가능합니다.

### 사용 예:

* 사용 중단된 메소드 변환: 사용 중단된 API 호출을 새로운 API로 자동 변환
* SQL 패턴 최적화: 예를 들어, `fetchCount()` 검사를 `fetchExists()`로 자동 최적화

이 기능은 코드베이스 전체에서 jOOQ API 사용 방식을 자동으로 개선하는 데 도움이 됩니다.

---

## 추가 데이터베이스 버전 지원

jOOQ 3.13에서 다음 데이터베이스 버전에 대한 기능 지원이 추가되었습니다:

* Firebird 3.0+: Firebird 3.0 이상 버전의 새로운 기능 지원
* MariaDB 10.3+: MariaDB 10.3 이상 버전의 새로운 기능 지원
* MySQL 8+: MySQL 8 이상 버전의 새로운 기능 지원
* PostgreSQL 10+: PostgreSQL 10 이상 버전의 새로운 기능 지원

---

## 빌드 인프라 개선

Jenkins 자동화가 향상되어 더 빈번한 스냅샷 및 패치 릴리스가 가능해졌습니다. 이를 통해:

* 더 빠른 버그 수정 배포: 패치가 더 빨리 사용자에게 전달됩니다
* 시험 버전 제공: Java 6, 8, 11용 시험 버전이 등록 없이 제공됩니다
* 지속적인 스냅샷 릴리스: 개발 중인 기능을 미리 테스트할 수 있습니다

---

## 맺음말

jOOQ 3.13은 DDL 관리 및 스키마 마이그레이션 도구에 대한 중요한 투자를 보여주는 릴리스입니다. Meta.migrateTo() API와 LiquibaseDatabase 통합은 데이터베이스 스키마 진화를 관리하는 새로운 방법을 제공합니다. CockroachDB 지원과 SQL:2011 시간 테이블 기능은 jOOQ가 지원하는 데이터베이스와 SQL 표준의 범위를 확장합니다.

이러한 기능들은 현대적인 데이터베이스 개발 워크플로우에서 jOOQ를 더욱 강력한 도구로 만들어줍니다.
