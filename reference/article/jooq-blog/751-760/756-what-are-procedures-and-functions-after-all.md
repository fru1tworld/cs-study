# 프로시저와 함수란 결국 무엇인가?

> 원문: https://blog.jooq.org/what-are-procedures-and-functions-after-all/

많은 RDBMS가 "루틴(routine)"이라는 개념을 지원하며, 이를 보통 프로시저(procedure) 및/또는 함수(function)라고 부른다. 이 개념들은 데이터베이스 외부의 프로그래밍 언어에서도 한동안 존재해 왔다. 프로시저와 함수를 구분하는 대표적인 언어로는 다음이 있다:

- Ada
- BASIC
- Pascal
- 기타 등등...

(저장) 프로시저와 (저장) 함수의 일반적인 차이점은 다음과 같이 요약할 수 있다:

프로시저:

- JDBC의 `CallableStatement`을 사용하여 호출한다
- 반환 값이 없다
- 보통 OUT 매개변수를 지원한다

함수:

- SQL 문 안에서 사용할 수 있다
- 반환 값이 있다
- 보통 OUT 매개변수를 지원하지 않는다

하지만 이 규칙에는 예외가 있다:

- DB2, H2, HSQLDB는 함수를 호출할 때 JDBC 이스케이프 구문(escape syntax)을 허용하지 않는다. 함수는 반드시 SELECT 문 안에서 사용해야 한다.
- H2는 함수만 존재한다(OUT 매개변수 없이).
- Oracle 함수는 OUT 매개변수를 가질 수 있다.
- Oracle에는 트랜잭션 관련 이유로 SQL 문 안에서 사용해서는 안 되는 함수가 존재한다.
- PostgreSQL은 함수만 존재한다(모든 기능이 결합되어 있다). OUT 매개변수는 반환 값으로도 해석될 수 있는데, 취향에 따라 꽤 우아하다고 할 수도 있고 기괴하다고 할 수도 있다.
- Sybase의 jconn3 JDBC 드라이버는 함수에 대해 JDBC 이스케이프 구문을 사용할 때 null 값을 올바르게 처리하지 못한다.

일반적으로, 루틴(프로시저/함수) 분야는 현대 RDBMS에서 표준화와는 거리가 멀다고 할 수 있다. 각 데이터베이스마다 고유한 방식이 있으며, JDBC는 프로시저/함수 구현의 다양한 차이에 대해 거의 추상화를 제공하지 않는다. 특히 커서(cursor), 사용자 정의 타입(UDT), 배열(array)과 같은 고급 데이터 타입이 관련될 경우에는 더욱 그렇다.
