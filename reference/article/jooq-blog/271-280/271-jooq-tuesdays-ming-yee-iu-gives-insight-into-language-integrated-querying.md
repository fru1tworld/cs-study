# jOOQ 화요일: Ming-Yee Iu가 언어 통합 쿼리에 대한 통찰을 제공하다

> 원문: https://blog.jooq.org/jooq-tuesdays-ming-yee-iu-gives-insight-into-language-integrated-querying/

jOOQ 화요일 시리즈에 오신 것을 환영합니다. 이 시리즈에서는 격월로 셋째 주 화요일에 jOOQ 관점에서 업계의 흥미로운 인물을 인터뷰하는 기사를 게시합니다. 여기에는 SQL, Java, 오픈 소스 및 관련 주제를 다루는 분들이 포함됩니다.

이번 여덟 번째 에디션에서는 Ming-Yee Iu를 만나 업계의 여러 사람들이 범용 언어에 쿼리 시스템을 통합하는 문제를 어떻게 해결해 왔는지, 그리고 그가 Java를 위해 만든 라이브러리 JINQ에 대해 이야기를 나눕니다.

---

Q: Ming, C#에서 Java로 온 모든 사람들은 Java용 LINQ를 검색합니다. 당신은 JINQ로 바로 그것을 구현했습니다. 무엇이 당신을 그렇게 하도록 만들었나요?

A: "Jinq는 실제로 스위스 EPFL 대학에서의 제 박사 연구에서 시작되었습니다. 2005년에 그곳에서 박사 과정을 시작했을 때, 저는 논문 주제가 필요했고, 제 지도교수 Willy Zwaenepoel이 데이터베이스 코드 작성을 더 쉽게 만드는 것에 관심이 있다는 것을 알게 되었습니다. 저는 1997년에 IBM의 JVM 팀 중 하나에서 인턴으로 일하면서 Java 내부에 대한 약간의 배경 지식이 있었기 때문에, 이 문제를 살펴볼 때 더 낮은 수준의 시스템 관점에서 접근했습니다. 그 결과, 특정 유형의 Java 코드를 데이터베이스 쿼리로 재작성하는 바이트코드 재작성 방식의 아이디어를 떠올리게 되었습니다."

"LINQ 그룹을 포함하여 다른 연구 그룹들도 동시에 이 문제를 연구하고 있었습니다. 각 그룹은 자신들의 배경에 따라 다른 접근 방식을 생각해냈습니다. 기본적인 가정은 프로그래머들이 데이터베이스 코드를 작성하는 데 어려움을 겪는 이유가 의미론적 격차 때문이라는 것이었습니다. 관계형 데이터베이스 모델이 객체 지향 프로그래밍 모델과 너무 달라서 프로그래머들이 그 차이를 메우는 데 정신적 노력을 낭비한다는 것이었습니다."

"초기 접근 방식은 비교적 빠르게 생각해냈지만, 알고리즘을 더 견고하고 사용하기 좋게 다듬는 데는 수년이 걸렸습니다. LINQ 연구자들과 마찬가지로, 저도 제 알고리즘이 함수형 코드에서 가장 잘 작동한다는 것을 발견했습니다. 함수형 스타일의 코드는 부작용이 없기 때문에 분석하기가 더 쉽습니다."

"불행히도, 2010년에 박사 과정을 마쳤을 때 Java는 아직 함수형 프로그래밍을 제대로 지원하지 않았기 때문에, 연구를 잠시 접어두고 다른 일을 했습니다. 하지만 2014년에 Java 8이 마침내 람다와 함께 출시되었을 때, 예전 연구를 다시 살펴보기로 결정했습니다. Java 8 람다를 활용하고 현재의 엔터프라이즈 도구들과 통합하도록 연구를 적용했습니다. 그 결과가 바로 Java에서 LINQ 스타일 쿼리를 지원하는 오픈 소스 도구인 Jinq입니다."

---

Q: 최근 reddit 토론에서, 당신은 Java 언어 관리자들이 절대로 쿼리 시스템을 언어에 통합하지 않을 것이며, LINQ는 실수였다고 언급했습니다. 그러나 LINQ는 C#에서 엄청나게 인기가 있습니다. 왜 LINQ가 실수였나요?

A: "제 의견은 그것보다 조금 더 미묘합니다. LINQ는 C# 생태계에서는 매우 합리적이지만, Java에는 완전히 부적절하다고 생각합니다. 언어마다 다른 트레이드오프, 다른 철학, 다른 역사적 짐이 있습니다. Java에 쿼리 시스템을 통합하는 것은 Java 철학에 반하며 실수로 여겨질 것입니다. C#은 다른 트레이드오프를 염두에 두고 설계되었기 때문에, C#에 쿼리 통합과 같은 기능을 추가하는 것은 더 수용 가능합니다."

"C#은 빠르게 진화하도록 설계되었습니다. C#은 새로운 방식을 수용할 수 있도록 프로그래머들에게 정기적으로 오래된 코드를 버리도록 강요합니다. Joel on Software에 있는 오래된 글에서 Microsoft에 두 개의 진영이 있다고 설명합니다: 항상 하위 호환성을 유지하려는 Raymond Chen 진영과 몇 년 후에 버려질 수도 있는 반짝이는 새로운 기술을 항상 전파하는 MSDN Magazine 진영입니다."

"Java의 철학은 절대로 하위 호환성을 깨지 않는 것입니다. 1990년대의 오래된 Java 코드도 현대 Java에서 여전히 완벽하게 컴파일되고 실행됩니다. 따라서 Java에 새로운 기능을 추가하는 데는 엄청난 유지보수 부담이 따릅니다. 모든 기능은 수십 년 동안 유지되어야 합니다. Java에 기능이 추가되면, 하위 호환성을 깨뜨릴 수 있기 때문에 변경할 수 없습니다. 결과적으로, 시간의 검증을 견뎌낸 기능만이 Java에 추가될 후보가 됩니다."

"이러한 고착화의 한 예가 Java 직렬화입니다. 객체를 쉽게 디스크에 쓸 수 있는 것은 매우 편리합니다. 하지만 이 기능은 미래의 사용 사례에 충분히 유연하지 않은 아키텍처를 고착시켰습니다. 사람들은 객체를 JSON이나 XML로 직렬화하고 싶어하지만, 기존의 직렬화 프레임워크로는 그렇게 할 수 없습니다."

"Java에 LINQ 스타일 쿼리를 추가하면 비슷한 문제가 발생할 가능성이 높습니다. 오해하지 마세요. LINQ는 훌륭한 시스템입니다. 현재 객체 지향 언어에 쿼리 언어를 통합하는 가장 우아한 시스템입니다. 많은 사람들이 특히 LINQ 때문에 C#을 사용하는 것을 좋아합니다. 하지만 기반 기술은 아직 Java에 추가되기에는 너무 미성숙합니다. 연구자들은 여전히 언어에 쿼리 시스템을 임베딩하는 더 새롭고 나은 방법을 개발하고 있으므로, Java를 나중에 구식으로 여겨질 접근 방식에 고착시킬 매우 현실적인 위험이 있습니다."

"LINQ 표현식을 데이터베이스 쿼리로 변환하기 위해, Microsoft는 LINQ가 런타임에 람다 표현식의 추상 구문 트리를 검사할 수 있게 하는 일부 기능을 C#에 추가했습니다. 이 기능은 편리하지만, LINQ가 표현식에서만 작동하도록 제한합니다. LINQ는 문(statement)이 포함된 람다의 추상 구문 트리를 검사할 수 없기 때문에 문에서는 작동하지 않습니다."

"범용 프로그래밍 언어에서, 모든 언어 기본 요소는 다양한 구조와 프레임워크의 빌딩 블록으로 사용될 수 있을 만큼 충분히 표현력이 있어야 합니다. 하지만 이 람다 검사 기능은 결국 LINQ와 같은 쿼리 프레임워크에만 유용하게 되었습니다. 사실, Jinq는 이 기능이 필요하지도 않다는 것을 보여주었습니다. 컴파일된 바이트코드만 사용하여 LINQ 스타일 쿼리 시스템을 구축하는 것이 가능하며, 결과적으로 나오는 쿼리 시스템은 문과 다른 명령형 코드 구조를 처리할 수 있어 더 유연합니다."

"프로그래머들이 LINQ에 대해 더 많은 경험을 쌓으면서, LINQ보다 더 잘 작동할 수 있는 대안적 접근 방식이 있을지 궁금해하기 시작했습니다. LINQ는 프로그래머들이 SQL을 배울 필요 없이 함수형 스타일 코드를 작성할 수 있기 때문에 데이터베이스 쿼리를 더 쉽게 작성할 수 있게 해준다고 합니다. 하지만 실제로 LINQ를 잘 사용하려면 프로그래머는 여전히 SQL도 이해해야 합니다. 그런데 프로그래머가 이미 SQL을 이해하고 있다면, LINQ가 그들에게 어떤 이점을 줄까요? Slick보다 SQL 문법에 더 가깝고 새로운 SQL 기능을 빠르게 포함하도록 진화할 수 있는 jOOQ와 같은 쿼리 시스템을 사용하는 것이 더 나을까요? 아마도 쿼리 시스템은 필요하지도 않을 것입니다. 점점 더 많은 회사들이 쿼리를 전혀 지원하지 않는 NoSQL 데이터베이스를 채택하고 있습니다."

"LINQ 스타일 쿼리 시스템에 대한 우리의 이해가 얼마나 빠르게 진화하고 있는지를 고려하면, 현 시점에서 Java와 같은 언어에 직접 그 기능을 추가하는 것은 확실히 실수일 것입니다. 어떤 접근 방식이든 구식이 될 수 있고, 미래 버전의 Java에 큰 유지보수 부담을 줄 것입니다. 다행히도 Java 프로그래머들은 Jinq와 jOOQ 같은 라이브러리를 사용할 수 있는데, 이들은 LINQ의 대부분의 이점을 제공하면서도 LINQ처럼 긴밀한 언어 통합을 필요로 하지 않습니다."

---

Q: Lightbend는 Scala용 LINQ인 Slick을 유지보수합니다. JINQ는 Slick과 어떻게 비교되나요?

A: "둘 다 데이터베이스 쿼리를 위한 LINQ 스타일 인터페이스를 제공하려고 합니다. Slick은 Scala를 위해 설계되었기 때문에, 훌륭한 Scala 통합을 가지고 있으며 Scala의 더 표현력 있는 프로그래밍 모델을 사용하여 매우 우아한 구현을 제공할 수 있습니다. 하지만 Slick의 모든 이점을 얻으려면 Scala 생태계를 받아들여야 합니다."

"Jinq는 주로 Java와 함께 사용하도록 설계되었습니다. JPA와 Hibernate 같은 기존 Java 기술과 통합됩니다. Jinq는 기존의 JPA 엔티티 클래스와 함께 작동하기 때문에 Jinq를 채택할 때 기존 Java 엔터프라이즈 코드를 버릴 필요가 없습니다. Jinq는 점진적 채택을 위해 설계되었습니다. 일부 곳에서는 선택적으로 사용하고 다른 곳에서는 일반 JPA 코드로 대체할 수 있습니다. Jinq는 Scala와 함께 사용할 수 있지만, Scala를 사용하면서도 전체 Scala 생태계를 수용하지 않은 조직에게 더 유용합니다."

---

Q: JINQ는 Java 8이 Stream API를 도입했을 때 가장 큰 개선을 보았습니다. Java에서의 함수형 프로그래밍에 대한 당신의 의견은 무엇인가요?

A: "Java가 마침내 람다를 지원하게 되어 정말 기쁩니다. 프로그래머로서 제 삶을 훨씬 쉽게 만들어주는 엄청난 개선입니다. 시간이 지나면서 Java 언어 관리자들이 람다를 더 개선할 수 있기를 바랍니다."

"Jinq의 관점에서, Java 8 람다의 주요 약점 중 하나는 리플렉션 지원이 전혀 없다는 것입니다. Jinq는 람다를 디코딩하고 쿼리로 변환하기 위해 리플렉션 지원이 필요합니다. 리플렉션 지원이 없기 때문에, Jinq는 같은 정보를 얻기 위해 느리고 취약한 대체 기술을 사용해야 합니다."

"어노테이션 지원 부족과 람다를 어떻게 다룰지에 대한 좋은 JavaDoc 가이드라인 부족에 대한 약간의 불만도 있습니다. Streams API와 람다 메타팩토리도 저에게는 약간 지나치게 복잡해 보이며, 더 단순한 것이 더 나았을지 궁금합니다."

"하지만 일상적인 프로그래밍 관점에서, 람다를 호출하기 위한 문법적 설탕(syntactic sugar) 부족이 저를 반복적으로 좌절시킨 주요 문제라는 것을 발견했습니다. 꽤 사소한 것처럼 보이지만, 람다를 더 많이 사용할수록 이것이 정말 중요하다고 느낍니다."

"Java 8에서는 람다를 만들고 전달하는 것이 너무 쉬워서, 보통 람다가 단일 메서드를 가진 클래스로 표현된다는 사실을 완전히 무시할 수 있습니다. 코드를 람다의 관점에서 생각할 수 있습니다. Java 8 코드를 작성할 때 제 정신적 모델은 람다를 만들고 전달하는 것입니다. 하지만 실제로 람다를 호출해야 할 때, 람다의 마법은 완전히 무너집니다. 멈추고 기어를 바꿔서 람다를 클래스의 관점에서 생각해야 합니다."

"개인적으로, 람다를 호출하기 위해 어떤 메서드를 호출해야 하는지 이름을 절대 기억하지 못합니다. run()인가요, accept()인가요, consume()인가요, 아니면 apply()인가요? 메서드 이름을 찾기 위해 문서를 찾아봐야 하는 경우가 많은데, 이것이 집중력을 깨뜨립니다."

---

Q: Java 9는 리액티브 상호운용성을 위한 Flow API를 도입할 것입니다. 리액티브 JINQ를 구현할 계획이 있나요?

A: "솔직히 말해서, 저는 리액티브 API에 대해 그다지 익숙하지 않습니다. 최근에는 주로 데스크톱 애플리케이션 작업을 해왔기 때문에, 리액티브 접근 방식이 합리적일 만큼 충분한 규모의 문제를 다루지 않았습니다."

---

Q: 과거에 다른 프로젝트들을 진행하고 있다고 저에게 언급하셨습니다. 현재 무엇을 작업하고 계신가요?

A: "시간이 지나면 프로젝트가 쌓이기 쉽습니다. Jinq는 현재 대부분 안정적이지만, 가끔 버그 수정과 다른 변경 사항을 추가합니다. 벌크 업데이트 지원이나 개선된 코드 생성과 같이 추가될 수 있는 몇 가지 주요 기능이 아직 있지만, 그것들은 수행하려면 약간의 펀딩이 필요한 상당히 큰 작업입니다."

"가끔 Babylscript라는 프로그래밍 언어 작업을 합니다. 이것은 프랑스어, 중국어, 아랍어 및 기타 비영어 언어를 혼합하여 코드를 작성할 수 있는 다국어 프로그래밍 언어입니다. 그에 대한 동반 프로젝트로, 17개의 다른 언어로 프로그래밍을 가르치는 Programming Basics라는 아이들을 위한 프로그래밍 교육 웹사이트도 운영하고 있습니다."

"하지만 현재는 두 가지 프로젝트에 대부분의 시간을 쓰고 있습니다. 하나는 고급 그래디언트를 전문으로 하는 벡터 드로잉 프로그램인 Omber라는 아트 도구입니다. 다른 프로젝트는 데스크톱 Java 프로그램의 UI 프론트엔드로 HTML5를 사용하는 것입니다. 모든 UI 코드는 여전히 Java로 작성되지만, AWT나 Swing을 사용하는 대신 Java에 바인딩된 표준 DOM 인터페이스를 사용하여 HTML을 조작하게 됩니다. 부수적인 이점으로, 모든 UI 코드는 GWT를 사용하여 JavaScript로 재컴파일할 수 있어서, 웹 페이지에도 UI 코드를 재사용할 수 있습니다."

---

이 매우 흥미로운 인터뷰에 감사드립니다, Ming. jOOQ 블로그의 이전 게스트 포스트에서 JINQ에 대해 더 알아보시고, Ming의 JVMLS 2015 강연을 시청하세요.
