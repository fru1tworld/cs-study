# Java 8 금요일: 언어 설계는 미묘하다

> 원문: https://blog.jooq.org/java-8-friday-language-design-is-subtle/

Data Geekery에서 우리는 Java 8을 매우 좋아합니다. 우리는 jOOQ를 위한 더 나은 API를 개발하기 위해 람다 표현식과 함께 정말 열심히 작업하고 있으며, 우리는 Java 8의 등장을 축하하고 있습니다.

## Java 8 금요일

매주 금요일마다 Java 8의 새로운 튜토리얼 스타일의 블로그 게시물을 보여드리며, 이들은 우리가 jOOQ에서 활용하는 다양한 Java 8의 장점을 보여줍니다. GitHub에서 예제 소스 코드를 찾아보실 수 있습니다.

## 언어 설계는 미묘하다

지난주에 우리는 jOOQ 통합 테스트를 Java 8로 마이그레이션하는 데 시간을 보냈고, 이 과정에서 언어 설계가 만들어야 하는 절충안에 대한 실용적인 예제를 발견했습니다. `SQLDialect[]` 배열이 있고, 그것을 각 요소에 `.family()`를 호출하여 다른 배열로 변환하고 싶었습니다.

Java 7에서는 다음과 같이 작성했습니다:

```java
SQLDialect[] families = new SQLDialect[dialects.length];
for (int i = 0; i < families.length; i++)
    families[i] = dialects[i].family();
```

Java 8에서는 다음과 같이 작성할 수 있습니다:

```java
SQLDialect[] families = Stream.of(dialects)
    .map(d -> d.family())
    .toArray(SQLDialect[]::new);
```

두 번째 접근 방식이 약간 더 우아하게 느껴지지만, 사실 두 접근 방식 모두 똑같이 장황합니다. Stream API의 우아함에도 불구하고 말입니다.

## 하위 호환성의 절충

호환성 때문에 배열과 컬렉션은 Stream API와 통합된 메서드를 갖지 않습니다. 이러한 분리는 기존 코드를 깨뜨리지 않으려는 Java의 약속을 반영합니다. 통합된 인터페이스가 더 깔끔했을 것이지만 말입니다.

## Brian Goetz와의 대화

저자는 이전에 Java 8의 한계에 대한 비판을 게시한 적이 있습니다. 특히 default 메서드, 메서드 수정자 지원, 그리고 원시 타입 오버로드에 관한 것이었습니다. 이것은 언어 아키텍트인 Brian Goetz로부터 직접적인 피드백을 이끌어냈습니다. 그는 설계 철학을 다음과 같이 명확히 했습니다:

*"당신은 'default 메서드'를 원하는 것이 아니라, 트레이트(traits)를 원하는 것입니다. 그리고 그 구문은 단지 상기시켜주는 것일 뿐입니다..."*

Default 메서드는 대규모 하위 호환성을 깨뜨리는 변경 없이 API 진화를 가능하게 하는 필수적인 타협안이었습니다.

## 언어 설계의 교훈

Goetz는 "언어 설계 관련 사항은 내가 생각했던 것보다 더 미묘하다"고 강조했습니다. 이는 제약 조건이 구현 선택을 어떻게 형성하는지를 강조합니다. 전문가 그룹은 새로운 언어 기능을 도입하는 것보다 API 진화 메커니즘을 제공하는 것을 우선시했습니다.

전문가 그룹은 "API 진화를 위한 수단"을 제공하는 데 초점을 맞췄지, 추가적인 클래스 구축 도구를 제공하는 것이 아니었습니다. 그들은 "택하지 않은 길도 마찬가지로 좋거나 더 나았을 것"이라고 인정했습니다.

## Stack Overflow 커뮤니티 참여

투명성을 높이기 위해 저자는 Java 8 설계 결정에 대한 상세한 질문을 올렸습니다:

- 왜 인터페이스 메서드에서 final이 허용되지 않는가
- 왜 인터페이스 메서드에서 synchronized가 허용되지 않는가

이러한 질문들은 커뮤니티에서 상당한 관심을 받았습니다.

## 장기적 관점

Java가 Node.js 같은 플랫폼의 "쿨함"은 부족할지 모르지만, 하위 호환성과 안정성은 실질적인 가치를 제공합니다. 저자는 컴파일 오류나 버그 없이 통합 테스트를 Java 8로 성공적으로 마이그레이션했습니다 - 이것이 호환성의 실질적인 이점을 보여줍니다.

## Java 8의 이점 예시

팀은 람다를 사용한 중첩 트랜잭션 기능을 선보였습니다:

```java
ctx.transaction(c1 -> {
    DSL.using(c1)
        .insertInto(AUTHOR, AUTHOR.ID, AUTHOR.LAST_NAME)
        .values(3, "Doe")
        .execute();
    // 추가 작업들...
});
```

## 미래의 Java 개발

저자는 다가올 프로젝트들에 관심을 표했습니다:

- 값 타입(Value types)
- 선언 지점 가변성(Declaration-site variance)

둘 다 개선을 약속하면서도 하위 호환성 관리에 대한 질문을 제기합니다.

## 결론

"쿨하지 않다"는 평판에도 불구하고, 안정성과 신중한 진화를 우선시하는 Java의 설계 철학은 장기적인 전문 개발 요구를 효과적으로 충족시킵니다. 커뮤니티 참여와 전문가 그룹의 투명성은 사려 깊은 플랫폼 발전에 대한 헌신을 보여줍니다.
