# 모듈을 다른 파일로 분리하기

## 개요

모듈이 커지면 코드 구성과 탐색을 개선하기 위해 정의를 별도의 파일로 이동하는 것이 좋습니다. 이 섹션에서는 단일 파일에서 모듈을 자체 파일로 추출하는 방법을 설명합니다.

## 기본 모듈 추출

### 시작점

하나의 파일(크레이트 루트 파일 `src/lib.rs` 또는 `src/main.rs`와 같은)에 여러 모듈이 정의되어 있으면 별도의 파일로 추출할 수 있습니다.

### 단계 1: `front_of_house` 모듈 추출

**파일: src/lib.rs**
```rust
mod front_of_house;

pub use crate::front_of_house::hosting;

pub fn eat_at_restaurant() {
    hosting::add_to_waitlist();
}
```

모듈 본문을 `mod` 선언만으로 교체합니다. 컴파일러는 `src/front_of_house.rs`라는 파일에서 모듈 코드를 찾습니다.

**파일: src/front_of_house.rs**
```rust
pub mod hosting {
    pub fn add_to_waitlist() {}
}
```

## 중요한 개념

> 모듈 트리에서 `mod` 선언을 사용하여 파일을 **한 번만** 로드하면 됩니다. 컴파일러가 파일이 프로젝트의 일부임을 알게 되면, 다른 파일은 선언된 위치에 대한 경로를 사용하여 로드된 파일의 코드를 참조해야 합니다. `mod` 키워드는 다른 프로그래밍 언어의 "include" 연산이 **아닙니다**.

## 자식 모듈 추출

`hosting`(`front_of_house`의 자식)과 같은 자식 모듈의 경우 프로세스가 다릅니다:

### 단계 1: 부모 모듈 파일 업데이트

**파일: src/front_of_house.rs**
```rust
pub mod hosting;
```

### 단계 2: 디렉토리 및 자식 모듈 파일 생성

부모 모듈의 이름을 딴 디렉토리를 만들고 그 안에 자식 모듈 파일을 배치합니다:

**파일: src/front_of_house/hosting.rs**
```rust
pub fn add_to_waitlist() {}
```

디렉토리 구조가 모듈 트리 계층 구조와 일치합니다. `hosting.rs`가 `src/`에 직접 배치되면 컴파일러는 이를 `front_of_house`의 자식 대신 루트 모듈로 취급합니다.

## 대체 파일 경로

Rust는 두 가지 파일 경로 스타일을 지원합니다:

### 루트 모듈 `front_of_house`의 경우:
- **현대적 (관용적)**: `src/front_of_house.rs`
- **이전 스타일 (여전히 지원)**: `src/front_of_house/mod.rs`

### 서브모듈 `hosting`의 경우:
- **현대적 (관용적)**: `src/front_of_house/hosting.rs`
- **이전 스타일 (여전히 지원)**: `src/front_of_house/hosting/mod.rs`

### 대체 경로에 대한 참고 사항:
- 같은 모듈에 두 스타일을 모두 사용하면 컴파일러 오류가 발생합니다
- 서로 다른 모듈에서 스타일을 혼합하는 것은 허용되지만 잠재적으로 혼란스러울 수 있습니다
- `mod.rs` 스타일은 같은 이름의 여러 파일을 생성할 수 있어 편집기에서 혼란스러울 수 있습니다

## 핵심 포인트

1. **모듈 트리는 변경되지 않음**: 모듈을 별도의 파일로 추출해도 모듈 계층 구조나 접근 방식은 변경되지 않습니다
2. **함수 호출은 변경 없이 작동**: `eat_at_restaurant()`와 같은 코드는 수정 없이 계속 작동합니다
3. **`pub use` 문은 변경 없음**: `src/lib.rs`의 다시 내보내기 문은 동일하게 유지됩니다
4. **`use`는 컴파일에 영향을 주지 않음**: `use` 키워드는 어떤 파일이 컴파일되는지에 영향을 미치지 않고 가시성에만 영향을 미칩니다
5. **`mod`는 포함이 아닌 선언**: `mod` 키워드는 모듈을 선언합니다. Rust는 모듈 이름의 파일을 자동으로 찾습니다

## 요약

Rust를 사용하면:
- 패키지를 여러 크레이트로 분할
- 크레이트를 모듈로 나누기
- 절대 또는 상대 경로를 사용하여 모듈 간에 항목 참조
- `use` 문으로 경로를 스코프로 가져오기
- `pub` 키워드로 정의를 공개
- 모듈이 커지면 별도의 파일로 이동하여 코드 구성

이 기술은 동일한 모듈 구조와 접근 패턴을 유지하면서 깔끔한 코드 구성을 가능하게 합니다.
