# 2장 개략적인 규모 측정

시스템 용량 및 성능 요구사항을 추정해 보라는 요구를 받는데 개략적인 규모 추정은 보편적으로 통용되는 성능 수치상에서 사고 실험을 행하여 추정치를 계산하는 행위로서, 어떤 설계가 요구사항에 부합할 것인지 보기 위한 것이다.

## 2의 제곱 수

분산 시스템에서 다루는 데이터 양은 엄청나게 커질 수 있으나 그 계산법은 기본을 크게 벗어나지 않는다.

제대로 된 계산 결과를 얻으려면 데이터 볼륨의 단위를 2의 제곱수로 표현하면 어떻게 되는지를 우선 알아야 한다.

## 모든 프로그래머가 알아야 하는 응답지연 값

| 연산명                                          | 시간            |
| ----------------------------------------------- | --------------- |
| L1 캐시 참조                                    | 0.5ns           |
| 분기 예측 오류                                  | 5ns             |
| L2 캐시 참조                                    | 7ns             |
| 뮤텍스 락/언락                                  | 100ns           |
| 주 메모리 참조                                  | 100ns           |
| Zippy로 1kb 압축                                | 10,000ns = 10us |
| 1Gbps 네트워크로 2kb 전송                       | 20us            |
| 메모리에서 1MB 순차적으로 read                  | 250us           |
| 같은 데이터 센터 내에서의 메시지 왕복 지연시간  | 500us           |
| 디스크 탐색(seek)                               | 10ms            |
| 네트워크에서 1MB 순차적으로 read                | 10ms            |
| 디스크에서 1MB 순차적으로 read                  | 30ms            |
| 한 패킷의 CA로부터 네덜란지까지의 왕복 지연시간 | 150ms           |

다음과 같은 결론

- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색은 가능한 한 피하라
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들

고가용성은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어.

| 가용률   | 하루당 장애시간 | 주당 장애시간 | 개월당 장애시간 | 연간 장애시간 |
| -------- | --------------- | ------------- | --------------- | ------------- |
| 99%      | 14.4분          | 1.68시간      | 7.31시간        | 3.65일        |
| 99.9%    | 1.44분          | 10.08분       | 43.83분         | 8.77시간      |
| 99.99%   | 8.64초          | 1.01분        | 4.38분          | 52.6분        |
| 99.999%  | 864ms           | 6.05초        | 26.3초          | 5.26분        |
| 99.0000% | 86.4ms          | 604.8ms       | 2.63초          | 31.56초       |

## 트위터 QPS와 저장소 요구량 추정

## 팁
