# 4장 설계 품질과 트레이드오프

## 데이터 중심 설계의 문제점

객체지향 설계에서 가장 중요한 것은 **책임**이다.

객체지향 설계란 **올바른 객체에게 올바른 책임을 할당**하면서 **낮은 결합도**와 **높은 응집도**를 가진 구조를 창조하는 활동이다.

설계를 진행하는 동안 데이터와 프로세스를 별도의 모듈에 배치하는 방법을 **데이터 중심 설계**라고 부른다.

데이터 중심 설계가 가진 문제점:

- 캡슐화 위반
- 높은 결합도
- 낮은 응집도

## 데이터 중심 설계

데이터 중심의 관점에서 객체는 자신이 포함하고 있는 데이터를 조작하는 데 필요한 오퍼레이션을 정의한다.

책임 중심의 관점에서 객체는 다른 객체가 요청할 수 있는 오퍼레이션을 위해 필요한 상태를 보관한다.

데이터 중심 설계의 문제점:

1. **본질적으로 너무 이른 시기에 데이터에 관해 결정하도록 강요한다**
2. **협력이라는 문맥을 고려하지 않고 객체를 고립시킨 채 오퍼레이션을 결정한다**

## 설계 트레이드오프

### 캡슐화

**캡슐화**란 변경 가능성이 높은 부분을 객체 내부로 숨기는 추상화 기법이다.

**변경될 가능성이 높은 부분을 구현**이라고 부르고 **상대적으로 안정적인 부분을 인터페이스**라고 부른다.

캡슐화의 정도가 응집도와 결합도에 영향을 미친다.

### 응집도와 결합도

**응집도(cohesion)**는 모듈에 포함된 내부 요소들이 연관돼 있는 정도를 나타낸다.

객체지향의 관점에서 응집도는 **객체 또는 클래스에 얼마나 관련 높은 책임들을 할당했는지**를 나타낸다.

**결합도(coupling)**는 의존성의 정도를 나타내며 다른 모듈에 대해 얼마나 많은 지식을 갖고 있는지를 나타내는 척도다.

## 데이터 중심의 영화 예매 시스템

데이터 중심 설계는 객체가 내부에 저장해야 하는 **데이터가 무엇인가**를 먼저 결정한다.

그 후에 데이터를 처리하는 데 필요한 오퍼레이션을 결정한다.

### 데이터 중심 설계의 문제점

데이터 중심 설계는 접근자(getter)와 수정자(setter)를 과도하게 추가하게 되는 경향이 있다.

접근자와 수정자는 public 속성과 거의 차이가 없다.

## 설계 트레이드오프

### 캡슐화 위반

데이터 중심 설계는 객체의 내부 구현을 인터페이스에 노출시키기 때문에 캡슐화를 위반한다.

### 높은 결합도

데이터 중심 설계는 접근자와 수정자를 통해 내부 구현을 인터페이스의 일부로 만들기 때문에 캡슐화를 위반한다.

이는 객체 내부 구현이 객체의 인터페이스에 드러난다는 것을 의미하며, 클라이언트가 구현에 강하게 결합된다는 것을 의미한다.

### 낮은 응집도

서로 다른 이유로 변경되는 코드가 하나의 모듈 안에 공존할 때 모듈의 응집도가 낮다고 말한다.

단일 책임 원칙(Single Responsibility Principle, SRP):

- 클래스는 단 한 가지의 변경 이유만 가져야 한다

## 자율적인 객체를 향해

### 캡슐화를 지켜라

캡슐화는 설계의 제1원리다.

객체는 자신이 어떤 데이터를 가지고 있는지를 내부에 캡슐화하고 외부에 공개해서는 안 된다.

객체는 스스로의 상태를 책임져야 하며 외부에서는 인터페이스에 정의된 메서드를 통해서만 상태에 접근할 수 있어야 한다.

### 스스로 자신의 데이터를 책임지는 객체

객체는 단순히 데이터 제공자가 아니다.

객체는 협력에 참여하면서 수행할 책임을 정의하는 오퍼레이션의 집합을 제공한다.

## 하지만 여전히 부족하다

본질적으로 데이터 중심 설계는 **너무 이른 시기에** 데이터에 대해 고민하기 때문에 캡슐화에 실패한다.

## 정리

데이터 중심 설계는 객체의 행동보다는 상태에 초점을 맞춘다.

데이터 중심 설계는 객체를 고립시킨 채 오퍼레이션을 정의하도록 만든다.

책임 중심 설계는 협력이라는 문맥 안에서 객체가 수행할 책임에 초점을 맞춘다.
