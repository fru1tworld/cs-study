# 2장 URL과 리소스

URL은 인터넷의 리소스를 가리키는 표준이름이다.

이번 챕터에서는 아래와 같은 정보를 알 수 있다.

- URL 문법, 여러 URL 컴포터넌트가 어떤 의미를 가지며, 무엇을 수행하는지
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서,
- URL의 인코딩과 문자규칙
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능하게 해주는 URN을 포함한 URL의 미래

## 2.1 인터넷의 리소스 탐색하기

URLdms 통합 자원 식별자 혹은 URI라고 불리는 더 일반화된 부류의 부분집합이다.

URI는 두 가지 주요 부분집합인, URL과 URN으로 구성된 종합적인 개념이다.

URN은 현재 그 리소스가 어디에 존재하든 상관없이 그 이름만으로 리소스를 식별하는데 비해 URL은 리소스가 어디 있는지 설명해서 리소스를 식별한다

HTTP 명세에서는 URI를 더 일반화된 개념의 리소스 식별자로 사용한다.

하지만 실제로 HTTP 애플리케이션은 URL을 URI의 한 부분으로 취급한다.

`http:www.naver.com/blog/index.html`을 살펴보자

- URL의 첫 부분은 URL의 스킴이다.
- 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려준다. 이 경우에 URL이 HTTP 프로토콜을 사용한다.
- URL의 두 번째 부분은 www.naver.com은 서버의 위치다. 이는 웹 클라이언트가 리소스가 어디에 호스팅 되어 있는지 알려준다.
- 세번째 부분은 경로다. 경로는 서버에 존재하는 로컬 리소스들 중에서 요청 받은 리소스가 무엇인지 알려준다.

URL은 mailto, ftp rtsp 등 다양한 프로토콜을 사용할수도 있다.
URL을 사용하면 리소스를 일관된 방식으로 사용할 수 있다.
대부분의 URL은 스킴://서버위치//경로 구조로 이루어져 있다.

## 2.2 URL 문법

URL의 다른 문법을 사용한다는 것은 다른 문법을 사용한다는 것일까 ?
사실은 그렇지 않다 대부분의 URL은 일반 URL 문법을 따르며, 서로 다른 URI 스킴도 형태와 문법 면에서 매우 유사하다.

대부분은 다음과 같이 나뉜다.

`<스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의?#<프래그먼트>`

### 2.2.1 스킴: 사용할 프로토콜

스킴은 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보다.

이는 URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를요청해야 하는지 알려준다.

위에서 예로 사용하고 있는 URL의 스킴은 http이다.

참고로 대소문자를 가리지 않는다.

### 2.2.2 호스트와 포트pe

애플리케이션이 인터넷에 있는 리소스를 찾으려면 리소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 알아야 한다.

URL의 호스트와 포트 컴포넌트는 그 두 가지 정보를 제공해준다.

호스트 컴포넌트는 접근하려고 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킨다.

### 2.2.3 사용자 이름과 비밀번호

많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다. FTP 서버가 좋은 예다.

- `ftp://ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://annoymous@ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://anonymouus:my_passwd@ftp.prep.ai.mit.edu/pub/gnu`
- `http://joe:joespasswd@www.joes-hardware.com/slaes_info.txt`

예를 들어 사용자가 사용자 이름과 비밀번호를 기술하지 않고 FTP URL에 접근하면 기본 값은 anonymous가 된다.
그리고 브라우저마다 가지고 있는 기본 값을 사용한다. (크롬은 chrome@example.com 을 넣는다)

### 2.2.4 경로

URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다.

해당 경로는 아래 예와 같이 계층적 파일 시스템 경로와 유사한 구를 가진다.

(유닉스 파일 시스템의 파일 경로와 유사하게)

### 2.2.5 파라미터

URL의 파라미터 컴포넌트는 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다.

이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 `;` 문자로 구분하여 URL 에 기술한다.

### 2.2.6 질의 문자열

데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.

? 우측에 있는 값들은 질의 컴포넌트라고 한다.

### 2.2.7 프래그먼트

HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나누리 수 있다.

예를 들어 paragraph가 포함되어있는 경우 특정 부분만 나타낼 수 있는데 이게 프래그먼트이다.

일반적으로 HTTP 서버는 객체 일부가 아닌 전체만 다루기 때문에 클라이언트는 서버에 프래그먼트를 전달하지 않는다.

## 2.3 단축 URL

웹 클라이언트는 몇몇 단축 URL을 인식하고 사용한다.

상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있다.

많은 브라우저가 사용자가 기억하고 있는 URL 일부를 입력하면 나머지 부분을 자동으로 입력해주는 URL 자동 확장을 지원한다.

### 2.3.1 상대 URL

URL은 상대 URL와 절대 URL로 나뉠 수 있다.

지금까지 우리가 본 것들은 절대 URL뿐인데, 상대 URL은 모든 정보를 담고 있지 않다.

그래서 base라고 하는 다른 URL을 사용해야 한다.

상대 URL은 URL을 짧게 표기하는 방식이다.

변환 과정에서 여러가지 케이스에 따라 상속받아서 사용함

### 2.3.2 URL 확장

어떤 브라우저들은 URL을 입력한 다음이나 입력하고 있는 동안에 자동으로 URL을 확장한다.

이는 사용자가 URL을 빠르게 입력하게 도와준다.

자동으로 URL이 확장되기 때문에 URL 전체를 입력하지 않아도 된다.

#### 호스트 명 확장

호스트 명 확장 기능을 제공하는 브라우저는 단순한 휴리스틱만을 사용해서 입력한 호스트명을 전체 호스트 명으로 확장할 수 있다.

예를 들어 yahoo를 입력하면 자동으로 www와 .com을 붙여서 만든다.

그런데 이런 기능에 의해서 확장 기능은 프락시와 같은 다른 HTTP 애플리케이션에 문제를 발생할 수 있는데 이는 6장에서 살펴보곘다.

#### 히스토리 명 확장

URL 기록을 저장해놓는데, 그래서 그 앞글자들을 포함한 완결된 형태의 URL를 선택할 수 있게 해준다.
그런데 마찬가지로 프락시를 사용할 경우 다르게 동작할 수 있다는 것을 유념하자.

## 2.4 안전하지 않은 문자

URL은 잘 호환되도록 설계되어있다.

안전한 전송이란 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미한다.

예를 들어 SMTP에서는 특정 문자를 제거할 수도 있는 전송 방식을 사용한다.

안전하지 않은 문자의 경우 이스케이프라는 기능을 추가해서 인코딩할 수 있게 하였다.

## 2.4.1 URL 문자 집합

역사적으로 많은 애플리케이션은 US-ASCII 문자집합을 사용하였다.

## 2.4.2 인코딩 체계

그 표현의 한계를 넘기 위해 고안되었다 안전하지 않은 문자를 %로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꾼다.

## 2.4.3 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다. 어떤 문자는 US-ASCII의 출력 가능한 문자집합에 포함되어있지 않다.
그리고 어떤 문자는 혼동되는 것으로 알려져 있어 사용이 꺼려지기도 했다.

| 문자            | 선점 및 제한                                                                                                            |
| --------------- | ----------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- |
| %               | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점                                                                         |
| /               | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점                                                                 |
| .               | 경로 컴포넌트에서 선점                                                                                                  |
| ..              | 경로 컴포넌트에서 선점                                                                                                  |
| #               | 프래그먼트의 구획 문자로 선점                                                                                           |
| ?               | 질의 문자열의 구획 문자로 선점                                                                                          |
| ;               | 파라미터의 구획 문자로 선점                                                                                             |
| :               | 스킴, 사용자이름/ 비밀번호 호스트/포트의 구획 문자로 선점                                                               |
| @, &,=          | 선점                                                                                                                    |
| {}              | / ~ []                                                                                                                  | 게이트웨이 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 제한됨 |
| <> "            | 안전하지 않음, 웹 문서에서 URL을 구분지어 표시하듯이 URL 범위 밖에서 역할이 있는 문자이기 때문에 반드시 인코딩해야한다. |
| 0x00-0x1F, 0x7f | 16 진수 범위에 속하는 문자들은 인쇄되지 않는 US-ASCII 문자다.                                                           |
| 0x7F            | 제한됨 이 범위에 속하는 문자들은 7비트 US-ASCII 문자가 아니다                                                           |

## 2.4.4 좀 더 알아보기

예쩐에 안전하지 않은 문자를 URL에 사용했어도 아무런 문제가 발생하지 않는데
애플리케이션 개발자들이 안전하지 않은 문자를 인코딩하지 않는 것은 실수다.

극단적인 방법은 모든 문자를 인코딩하는 것인데, 이 방식은 안전한 문자들을 인코딩하지 않는 애플리케이션도 있어서 오작동을 일으킬 수 있다.
