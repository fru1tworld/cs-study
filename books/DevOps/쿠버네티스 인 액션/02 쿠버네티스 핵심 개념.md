# 3. 파드: 쿠버네티스에서 컨테이너 실행

# 3.1 파드 소개

### 3.1.1. 파드가 필요한 이유

컨테이너는 기본적으로 단일 프로세스를 실행하는 것을 목표로 설계했다. (프로세스가 자식 프로세스를 생성하는 것을 제외하면)

모든 프로세스는 동일한 표준 출력으로 로그를 기록하기 때문에 어떤 프로세스가 남긴 로그인지 파악하는 것이 매우 어렵다.

따라서 각 프로세스를 자체의 개별 컨테이너로 실행해야 한다.

### 3.1.2. 파드 이해하기

여러 프로세스를 단일 컨테이너로 묶지 않기 때문에 상위 구조가 필요하며, 이것이 파드이다.

#### 같은 파드에서 컨테이너 간 분리

파드의 모든 컨테이너는 동일한 네트워크 네임스페이스와 UTS 네임스페이스 안에서 실행되기 때문에 모든 컨테이너는 같은 호스트 이름과 네트워크 인터페이스를 공유한다.

그러나 파일 시스템에 한해서 사정이 조금 다르다.
이는 볼륨의 개념에서 더 살펴볼 것이다.

#### 컨테이너가 동일한 IP와 포트 공간을 공유하는 방법

여기서 강조할 한 가지는 파드 안의 컨테이너가 동일한 네트워크 네임스페이스에서 실행되기 때문에, 동일한 IP 주소와 포트 공간을 공유한다는 것이다.

이는 동일한 파드 안 컨테이너에서 실행 중인 프로세스가 같은 포트 번호를 사용하지 않도록 주의해야 함을 의미한다.

모든 컨테이너는 동일한 루프백 네트워크 인터페이스를 갖기 때문에 컨테이너들이 로컬호스트를 통해 서로 통신할 수 있다.

#### 파드 간 플랫 네트워크

쿠버네티스 클러스터의 모든 파드는 하나의 플랫한 공간의 공유 네트워크 주소 공간에 상주하므로 모든 파드는 다른 파드의 IP 주소를 사용해 접근하는 것이 가능하다.

둘 사이에는 어떠한 NAT도 존재하지 않는다.
따라서 LAN의 통신과 동일하다.

### 3.1.3. 파드에서 컨테이너의 적절한 구성

파드를 각각 별도의 머신으로 생각할 수 있지만, 파드는 특정한 애플리케이션만을 호스팅한다.

한 호스트에 모든 유형의 애플리케이션을 넣었던 이전과 달리, 파드는 그렇게 사용하지 않는다.

### 다계층 애플리케이션을 여러 파드로 분할

### 개별 확장이 가능하도록 여러 파드로 분할

두 컨테이너를 하나의 파드에 넣지 말아야 하는 또 다른 이유는 스케일링 때문이고, 파드는 스케일링의 기본 단위다.

쿠버네티스는 개별 컨테이너를 수평으로 확장할 수 없다.

대신 전체 파드를 수평으로 확장한다.

### 파드에서 여러 컨테이너를 사용하는 경우

주 컨테이너가 있고 로그 수집기, 데이터 프로세서, 통신 어댑터와 같은 지원 컨테이너가 존재하는 경우 사이드카 컨테이너라고 한다.

### 파드에서 여러 컨테이너를 사용하는 경우 결정

컨테이너를 파드로 묶어 그룹으로 만들 때는, 즉 두 개의 컨테이너를 단일 파드로 넣을지 아니면 두 개의 별도 파드에 넣을지를 결정하기 위해 다음과 같은 질문을 할 필요가 있다.

# 3.2 YAML 또는 JSON 디스크립터로 파드 생성

### 파드를 정의하는 주요 부분 소개

Metadata: 이름, 네임스페이스, 레이블 및 파드에 관한 기타 정보를 포함한다.
Spec: 파드 컨테이너 볼륨, 기타 데이터 등 파드 자체에 관한 실제 명세를 가진다.
Status: 파드 상태, 각 컨테이너 설명과 상태 파드 내부 IP, 기타 기본 정보 등 현재 실행 중인 파드에 관한 현재 정보를 포함한다.

## 3.6 파드에 어노테이션 달기

파드 및 다른 오브젝트는 레이블 외에 어노테이션을 가질 수 있다.

어노테이션은 키-값 쌍으로 레이블과 거의 비슷하지만 식별 정보를 갖지 않는다.

레이블은 오브젝트를 묶는 데 사용할 수 있지만, 어노테이션은 그렇게 할 수 없다.

레이블 셀렉터를 통해서 오브젝트를 선택하는 것이 가능하지만 어노테이션 셀렉터와 같은 것은 없다.

# 3.7 네임스페이스를 사용한 리소스 그룹화

네임스페이스를 사용하면 오브젝트를 별도 그룹으로 분리해 특정한 네임스페이스 안에 속한 리소스를 대상으로 작업할 수 있게 해주지만, 실행 중인 오브젝트에 대한 격리는 제공하지 않는다.

# 3.8 파드 중지와 제거

# 3.9 요약

# 4. 레플리케이션과 그 밖의 컨트롤러: 관리되는 파드 배포
