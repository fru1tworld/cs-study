# 6.

## 6.1 서버의 개요

### 6.1.1 클라이언트와 서버의 차이점

패킷이 웹 서버에 도착하면 웹 서버는 이것을 수신하여 도착한 패킷을 처리하는데, 웹 서버의 동작이 여기에서 갑자기 시작되는 것은 아니다.

서버를 기동한 후 여러 가지 준비 동작을 하기 시작하여 클라이언트에서의 액세스에 응하는 상태가 된다.

클라이언트에서 도착한 패킷을 수신하여 처리하는 것은 이러한 준비 작업이 끝난 후의 일이다.

이 준비 작업을 포함한 서버의 전체 모습을 알지 못하면 서버의 동작을 이해할 수 없으므로 서버의 전체를 살펴보는 과정부터 설명한다.

먼저 서버와 클라이언트의 차이이다.

- 서버 머신은 용도에 따라 다양한 종류가 있으며 하드웨어나 OS 부분은 클라이언트와 다른 것도 존재한다.
  i 그러나 네트워크에 관한 부분은 즉 LAN 어댑터, 프로토콜 스택, Socket 라이브러리 등의 기능은 클라이언트와 동일하다.
- TCP나 IP의 기능은 하드웨어나 OS가 무엇이든지 달라지지 않기 때문에 기능이 통일되어 있다고 해도 좋다.

원래 가지고 있는 기능은 같아도 사용하는 방법까지 같은 것은 아니다.
- 접속 동작을 할 때 클라이언트에서 접속 동작을 수행하고, 서버는 그것을 기다리는 형태가 되므로 Socket 라이브러리의 사용법은 조금 달라진다.
- 그래서 애플리케이션이 호출하는 Socket 라이브러리의 프로그램 부품이 다른 것이다.
- 또한 서버의 애플리케이션은 동시에 다수의 클라이언트 PC와 대화한다는 차이점도 있다.
- 그렇기 때문에 서버 애플리케이션은 클라이언트 애플리케이션과 구조가 다르다.

### 6.1.2 서버 애플리케이션의 구조
- 서버는 동시에 복수의 클라이언트와 통신 동작을 실행하지만, 하나의 프로그램으로 여러 클라이언트를 처리하기는 어렵다.
- 어느 클라이언트와 어디까지 대화가 진행되고 있는지를 전부 파악해야 하기 때문이다. 
- 그래서 클라이언트가 접속할 때마다 새로 서버 프로그램을 작동하여 서버 애플리케이션이 클라이언트와 1대1로 대화하는 방법을 선택하는 것이 일반적이다. 
- 구체적으로는 다음과 같이 서버 프로그램을 만든다.. 
- 서버 프로그램을 접속을 기다리는 부분과 클라이언트와 대화하는 부분의 둘로 나누어 만든다.
그리고 서버 프로그램을 작동해서 설정 파일 읽기 등의 초기화 동작을 마쳤을 때 접속을 기다리는 부분을 실행한다. 
- 그러면 이 부분이 소켓을 작성하고 소켓을 클라이언트에서의 접속 동작을 기다리는 상태로 만든 채 쉬는 상태가 된다.
- 그러다 클라이언트가 접속했을 때 다시 작동하여 접속을 기다린다.
- 클라이언트와 대화하는 부분을 작동시켜서 그곳에 접속이 끝난 소켓을 건네 주고 동작을 계속하면 클라이언트와 대화하는 부분은 접속이 끝난 소켓을 사용하여 클라이언트와 대화하기 시작한다.
- 대화가 끝나면 연글을 끊고 이부분을 종료한다.

- 클라이언트와 대화하는 부분은 새 클라이언트가 접속할 때마다 잇달아 기동되므로 한 부분은 새 클라이언트가 접속 할때마다 잇달아 기동되므로 한 대의 클라이언트와 1대1로 대응된다.
- 이렇게 하면 다른 클라이언트의 일은 신경 쓰지 않고 자신에게 대응하는 클라이언트만 상대하면 된다.
- 서버 OS는 멀티태스크 또는 멀티 스레드라는 기능에 의해 다수의 프로그램을 동시에 함께 작동할 수 있는데, 이 성질을 이용한 프로그래밍 기법이라고 할 수 있다. 

### 6.1.3

## 6.2

### 6.2.1

### 6.2.2

### 6.2.3

### 6.2.4

### 6.2.5

## 6.3

### 6.3.1

### 6.3.2

### 6.3.3

### 6.3.4

## 6.4

### 6.4.1

### 6.4.2
